CREATE TABLE Users (
    ID INT PRIMARY KEY IDENTITY,
    Username VARCHAR(100) NOT NULL,
    Password VARBINARY(256) NOT NULL, modified==
    Email VARCHAR(100) UNIQUE NOT NULL,
    Role INT NOT NULL,
    Sex INT NOT NULL,
    DateOfBirth DATE NOT NULL
);

CREATE TABLE Friends (
    ID1 INT,
    ID2 INT,
    PRIMARY KEY(ID1, ID2),
    FOREIGN KEY (ID1) REFERENCES Users(ID),
    FOREIGN KEY (ID2) REFERENCES Users(ID)
);

CREATE TABLE URLS (
	ID INT,
	Url VARCHAR(100),
	FOREIGN KEY (ID) REFERENCES Users(ID) ON DELETE CASCADE,
	PRIMARY KEY(ID, Url)
);


CREATE TRIGGER trg_DeleteFriends
ON Users
INSTEAD OF DELETE
AS
BEGIN
    -- Delete related rows from Friends table first
    DELETE FROM Friends
    WHERE ID1 IN (SELECT ID FROM deleted)
       OR ID2 IN (SELECT ID FROM deleted);

    -- Now delete from Users table
    DELETE FROM Users
    WHERE ID IN (SELECT ID FROM deleted);
END;